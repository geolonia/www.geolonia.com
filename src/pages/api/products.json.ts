import type { APIRoute } from 'astro';
import { getCollection } from 'astro:content';

export const GET: APIRoute = async () => {
  // 製品ページを取得
  const pages = await getCollection('pages');
  const productsPage = pages.find(p => p.id === 'products.md');

  // 製品情報を構造化
  const products = {
    meta: {
      title: productsPage?.data.title || '株式会社Geolonia - プロダクト',
      description: productsPage?.data.description || 'Geoloniaが提供する位置情報テクノロジー製品・サービス',
      lastUpdated: new Date().toISOString(),
    },
    products: [
      {
        id: 'geolonia-maps',
        name: 'Geolonia Maps',
        category: '地図表示ライブラリ',
        description: 'ウェブサイトやアプリケーションに簡単に組み込める、高性能な地図表示ライブラリです。',
        url: '/maps/',
        features: [
          'シンプルで使いやすいAPI - 数行のコードで美しい地図を表示',
          '高速なレンダリング - ベクタータイルによる軽快な動作',
          '豊富なカスタマイズオプション - デザインを自由にカスタマイズ',
          'モバイル対応 - スマートフォン・タブレットでも快適に動作',
          'オープンソース - 透明性の高い開発プロセス',
        ],
        useCases: [
          '店舗検索システム - 複数店舗の位置を地図上に表示',
          '配送ルート表示 - リアルタイムの配送状況を可視化',
          'エリアマーケティング - 商圏分析や顧客分布の可視化',
          '観光案内アプリ - 観光スポットやイベント情報の地図表示',
          '不動産物件検索 - 物件情報を地図上で検索・比較',
        ],
        support: [
          '詳細なドキュメント',
          '豊富なコードサンプル',
          'メールサポート',
          'コミュニティフォーラム',
        ],
      },
      {
        id: 'smartcity-platform',
        name: 'スマートシティのための地理空間データ連携基盤',
        category: '自治体向けプラットフォーム',
        description: '自治体が保有する地理空間データを統合・管理し、住民サービスの向上や業務効率化を実現するプラットフォームです。',
        url: '/geolonia-maps-for-smartcity/',
        features: [
          '地理空間データの一元管理 - 散在するデータを統合管理',
          '部署間のデータ連携 - 部署の壁を越えたデータ共有',
          'オープンデータとしての公開 - 住民・企業へのデータ提供',
          '住民向けサービスへの活用 - 便利なアプリケーションの開発',
          '防災・減災への活用 - ハザードマップや避難所情報の統合',
        ],
        benefits: [
          'データの重複管理を解消 - 管理コストの削減',
          '業務の効率化 - データ入力作業の削減',
          '住民サービスの向上 - よりわかりやすい情報提供',
          'データ駆動型の政策立案 - 根拠に基づいた意思決定',
          'オープンガバメントの推進 - 透明性の高い行政運営',
        ],
        targetCustomers: [
          'DX推進を検討中の自治体',
          'スマートシティ構想に取り組む自治体',
          'オープンデータ推進を目指す自治体',
          '防災・減災対策を強化したい自治体',
        ],
        useCases: [
          '都市計画 - 土地利用計画や交通計画の策定',
          '防災対策 - ハザードマップの作成・公開',
          '公共施設管理 - 施設の位置・情報の一元管理',
          '観光振興 - 観光資源のマッピングと情報発信',
          '健康福祉 - 医療機関や福祉施設の情報提供',
        ],
      },
      {
        id: 'smartmap',
        name: '公開型GIS「スマートマップ」',
        category: '地図作成・公開システム',
        description: '専門知識がなくても、直感的な操作で地図を作成・公開できる公開型GISシステムです。',
        url: '/smartmap/',
        features: [
          '専門知識不要 - GISの専門知識がなくても使える',
          '簡単操作 - ドラッグ&ドロップで地図を作成',
          '豊富なデータ形式に対応 - CSV、GeoJSON、KMLなど',
          'レスポンシブデザイン - PCでもスマホでも見やすい',
          '高速な地図表示 - ストレスフリーな操作感',
          'カスタマイズ可能 - デザインを自由に変更',
        ],
        useCases: [
          '施設情報の公開 - 公共施設や店舗の位置情報',
          'イベント会場案内 - 会場マップやアクセス情報',
          '観光情報の提供 - 観光スポットや飲食店の紹介',
          '防災マップ - 避難所や給水所の位置情報',
          'ハザードマップ - 災害リスク情報の可視化',
          'コミュニティマップ - 地域の情報共有',
        ],
        workflow: [
          'データ準備 - Excel や CSV でデータを用意',
          'アップロード - ドラッグ&ドロップでデータを登録',
          'デザイン調整 - 色やアイコンをカスタマイズ',
          '公開 - URLを共有して情報を公開',
        ],
      },
      {
        id: 'address-normalization',
        name: '住所正規化ソリューション',
        category: '住所データ品質向上',
        description: '企業や自治体が保有する住所データを統一された形式に変換し、データの品質を向上させるソリューションです。',
        url: '/address-normalization/',
        challenges: [
          '全角・半角の混在 - 「1-2-3」と「１－２－３」',
          '番地表記のばらつき - 「1番2号」「1-2」「1丁目2番地」',
          '建物名の有無 - 「○○ビル3階」の表記揺れ',
          '旧住所表記の混在 - 住居表示実施前の地番',
          '略称・正式名称の混在 - 「東京都」「東京」',
        ],
        features: [
          '高精度な住所正規化 - 独自のアルゴリズムで高精度に正規化',
          '大量データの一括処理 - 数万件〜数百万件のデータを短時間で処理',
          'API経由での連携 - 既存システムとの連携が容易',
          '緯度経度の付与 - ジオコーディング機能を標準搭載',
          '継続的なデータメンテナンス - 住所変更にも対応',
        ],
        benefits: [
          'データ品質の向上 - 表記揺れのない統一されたデータ',
          '検索精度の向上 - 正確な住所検索が可能に',
          '業務効率化 - 手作業でのデータ整備が不要',
          '配送業務の最適化 - 正確な位置情報で配送を効率化',
          'マーケティング分析の高度化 - 地域分析の精度向上',
        ],
        offerings: [
          'クイック住所変換 - ブラウザで使える無料ツール',
          '住所正規化API - システム連携用のAPI',
          'エンタープライズ版 - 大量データ処理・オンプレミス対応',
        ],
      },
    ],
    otherServices: {
      api: [
        {
          name: '逆ジオコーダー',
          description: '緯度経度から住所を取得',
        },
        {
          name: '不動産共通ID',
          description: '不動産情報の標準化',
        },
        {
          name: '住所正規化API',
          description: 'プログラムから住所を正規化',
        },
      ],
      education: [
        {
          name: '地図ぼうけんラボ',
          description: '子供向け地図学習プラットフォーム',
        },
        {
          name: '技術ドキュメント',
          description: '開発者向け詳細ドキュメント',
        },
        {
          name: 'コードサンプル',
          description: 'すぐに使えるサンプルコード',
        },
      ],
    },
    pricing: {
      plans: [
        {
          name: '無料プラン',
          target: '個人・小規模利用向け',
        },
        {
          name: 'スタンダードプラン',
          target: '中小企業向け',
        },
        {
          name: 'エンタープライズプラン',
          target: '大企業・自治体向け',
        },
        {
          name: 'カスタムプラン',
          target: '特殊な要件に対応',
        },
      ],
      contactUrl: '/contact/',
    },
    faq: [
      {
        question: '商用利用は可能ですか？',
        answer: 'はい、すべてのプロダクトで商用利用が可能です。プランによってライセンス条件が異なりますので、詳細はお問い合わせください。',
      },
      {
        question: 'サポートはありますか？',
        answer: 'はい、メールサポート、技術ドキュメント、コードサンプルなどを提供しています。エンタープライズプランでは専任サポート担当が対応します。',
      },
      {
        question: 'オンプレミス環境での利用は可能ですか？',
        answer: 'はい、エンタープライズプランではオンプレミス環境での導入も可能です。詳しくはお問い合わせください。',
      },
      {
        question: 'データの更新頻度は？',
        answer: '地図データは定期的に更新されます。詳細な更新スケジュールについてはお問い合わせください。',
      },
    ],
    contact: {
      url: '/contact/',
      businessHours: '平日 10:00-18:00（土日祝日を除く）',
      inquiryTypes: [
        '製品デモのご依頼',
        '導入のご相談',
        'お見積りのご依頼',
        '技術的なご質問',
        'その他のお問い合わせ',
      ],
    },
  };

  return new Response(JSON.stringify(products, null, 2), {
    status: 200,
    headers: {
      'Content-Type': 'application/json; charset=utf-8',
    },
  });
};
