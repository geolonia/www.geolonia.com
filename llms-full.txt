# www.geolonia.com - Complete Project Documentation

## Project Information
- **Name**: www.geolonia.com
- **Type**: Corporate Website
- **Company**: Geolonia Inc. (株式会社Geolonia)
- **Purpose**: Public-facing corporate website showcasing products, services, and company information
- **Language**: Primarily Japanese, with English in technical documentation
- **Repository**: https://github.com/geolonia/www.geolonia.com

## Technical Architecture

### Framework & Build System
- **Framework**: Astro 5.17.1
- **Type**: Static Site Generator (SSG)
- **Build Output**: Static HTML, CSS, JavaScript
- **Development Server**: Port 8080
- **Node.js**: ES Modules (`"type": "module"` in package.json)

### Content Management
- **System**: Astro Content Collections
- **Format**: Markdown (.md) with YAML frontmatter
- **Location**: `src/content/pages/`
- **Collections**: pages, blog, news

### Testing
- **Framework**: Cucumber.js 12.6.0 (BDD)
- **Browser Automation**: Playwright 1.58.2
- **Test Language**: Japanese (Gherkin)
- **Test Files**: `.cjs` extension (CommonJS in ES module project)

## Key Design Patterns

### 1. Dynamic Header Styling
The header component (`src/components/Header.astro`) automatically adapts based on the current page:

**Home Page (`/`):**
- Background: Transparent
- Text Color: White (#fff)
- Logo: `geolonia_logo_white.png`
- Position: Absolute (overlays hero image)
- Class: `site-header--home`

**Child Pages (`/company/`, `/products/`, etc.):**
- Background: White (#fff)
- Text Color: Dark (#444)
- Logo: `geolonia_logo.png` (color)
- Position: Relative (normal flow)
- Box Shadow: `0 1px 3px rgba(0,0,0,0.05)`
- Class: `site-header--page`

Implementation uses `Astro.url.pathname` to detect current page.

### 2. Markdown Content Flow
1. Content is written in `src/content/pages/*.md`
2. Frontmatter defines metadata (title, description)
3. Page routes in `src/pages/*.astro` use `getEntry()` to load content
4. `MarkdownPageLayout.astro` provides consistent styling
5. Content is rendered via `<Content />` component

### 3. Content Collections Schema
Defined in `src/content/config.ts`:
- **pages**: title (string), description (string, optional)
- **blog**: title, description, pubDate, updatedDate, author, tags
- **news**: title, description, pubDate, category

## File Structure Details

### Source Files (`src/`)
```
src/
├── components/
│   ├── Header.astro          # Adaptive header with home/child page styles
│   └── Footer.astro          # Site footer with company info
├── layouts/
│   ├── BaseLayout.astro      # Base HTML structure, global styles
│   └── MarkdownPageLayout.astro  # Layout for markdown-based pages
├── content/
│   ├── config.ts             # Content collection definitions
│   ├── pages/                # Markdown content for all pages
│   │   ├── company/
│   │   │   ├── index.md      # Company overview
│   │   │   └── recruit.md    # Recruitment info
│   │   ├── products.md
│   │   ├── developer.md
│   │   └── ...
│   ├── blog/                 # Blog posts (MDX)
│   └── news/                 # News articles
└── pages/                    # Route definitions
    ├── index.astro           # Homepage
    ├── company/
    │   └── index.astro       # Loads content from content/pages/company/index.md
    └── ...
```

### Test Files (`features/`)
```
features/
├── navigation.feature         # Menu and page access tests
├── header-styles.feature     # Header styling verification
├── content.feature           # Content rendering tests
├── responsive.feature        # Responsive design tests
├── step_definitions/
│   └── steps.cjs             # Step implementations (CommonJS)
└── support/
    └── world.cjs             # Test context and browser setup
```

## Testing Strategy

### Test Scenarios (Cucumber/Japanese)
1. **Navigation Tests** (`navigation.feature`)
   - All menu pages are accessible
   - Submenu hover functionality
   - Page title verification

2. **Header Style Tests** (`header-styles.feature`)
   - Home page: transparent background, white text
   - Child pages: white background, dark text
   - Logo image switching (white vs color)

3. **Content Tests** (`content.feature`)
   - Markdown rendering (headings, lists, tables)
   - Link functionality
   - Table display

4. **Responsive Tests** (`responsive.feature`)
   - Desktop layout (1440x900)
   - Mobile layout (375x667)
   - Content width constraints

### Running Tests
```bash
# Start dev server first
npm run dev

# In separate terminal
npm test           # Run all tests
npm run test:ci    # CI mode with JSON output
```

## Styling Guidelines

### CSS Variables
- Primary Color: `#f39813`
- Primary Dark: `#c2790f`
- Primary Vivid: `#ffa714`
- Text Header: `#444`
- Text Body: `#333`
- Text Light: `#666`

### Container & Breakpoints
- Max Container Width: `1140px`
- Mobile: `max-width: 768px`
- Tablet: `max-width: 991px`
- Desktop: `min-width: 992px`

### Spacing
- Hero Section Padding: `60px 0`
- Content Section: Bottom padding `80px`
- Container Padding: `0 15px`

## Development Workflow

### Starting Development
```bash
npm install        # Install dependencies
npm run dev        # Start dev server (http://localhost:8080)
```

### Editing Content
1. Locate markdown file in `src/content/pages/`
2. Edit frontmatter (YAML) and/or content (Markdown)
3. Save file
4. Changes auto-reload in browser

### Adding New Page
1. Create markdown file: `src/content/pages/new-page.md`
2. Add frontmatter with title and description
3. Create route: `src/pages/new-page/index.astro`
4. Use `getEntry('pages', 'new-page')` to load content
5. Wrap in `MarkdownPageLayout`

### Building for Production
```bash
npm run build      # Type check + build
npm run preview    # Preview build output
```

## License Structure

### Three-Part License
1. **Source Code**: MIT License
   - Covers: HTML, CSS, JavaScript, Astro components
   - Allows: Commercial use, modification, distribution
   - Requires: Attribution

2. **Content**: All Rights Reserved
   - Covers: Text, images, company info, product descriptions
   - Requires: Written permission for use

3. **Trademarks**: Registered Trademark Protection
   - **Geolonia®** is a registered trademark
   - Logo and brand assets protected
   - Requires: Written permission for use

See `LICENSE` file for complete terms.

## Dependencies

### Production
- `astro`: 5.17.1
- `@astrojs/mdx`: 4.3.13
- `@astrojs/sitemap`: 3.7.0

### Development
- `@astrojs/check`: 0.9.6 (Type checking)
- `@cucumber/cucumber`: 12.6.0 (BDD testing)
- `@playwright/test`: 1.58.2 (Browser automation)
- `typescript`: 5.9.3

## Configuration Files

### astro.config.mjs
- Site URL: `https://www.geolonia.com`
- Server port: 8080
- Integrations: MDX, Sitemap
- Markdown theme: `github-dark`

### cucumber.cjs
- Requires: `features/step_definitions/**/*.cjs`, `features/support/**/*.cjs`
- Format: Progress + HTML report
- Output: `test-results/cucumber-report.html`

### package.json
- Type: ES Module (`"type": "module"`)
- Scripts: dev, build, preview, test, test:ci
- License: MIT

## Important Notes

### File Extensions
- Test files use `.cjs` (CommonJS) due to `"type": "module"` in package.json
- Astro components use `.astro`
- Content uses `.md` or `.mdx`

### Git Workflow
- Main branch: `main`
- Commit before testing
- Test before deploying
- Use semantic commit messages

### Performance Considerations
- Static HTML generation (no client-side JavaScript by default)
- Optimize images before adding to `public/images/`
- Minimize CSS (scoped styles in Astro components)

## Deployment Checklist
See CLAUDE.md for complete deployment checklist including:
1. Code quality checks
2. Test execution
3. **llms.txt and llms-full.txt updates** (REQUIRED)
4. Build verification
5. Final checks
6. Deployment execution
7. Post-deployment verification
8. Rollback procedures

## Troubleshooting

### Port 8080 in use
```bash
lsof -ti:8080 | xargs kill
```

### Build errors
```bash
rm -rf .astro dist node_modules package-lock.json
npm install
npm run build
```

### Test failures
1. Ensure dev server is running (`npm run dev`)
2. Verify http://localhost:8080 is accessible
3. Check browser manually
4. Re-run tests

## Contact & Resources
- Website: https://www.geolonia.com
- Contact: https://www.geolonia.com/contact/
- GitHub: https://github.com/geolonia/www.geolonia.com
- Astro Docs: https://docs.astro.build/
- Cucumber Docs: https://cucumber.io/docs/cucumber/
- Playwright Docs: https://playwright.dev/

---
Last updated: 2024-02-08
Version: 1.0.0
